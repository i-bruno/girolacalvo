<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./assets/icons/girola.svg" type="image/x-icon">
    <link rel="stylesheet" href="estilo.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <title>Prueba</title>
</head>

<body>
    <div class="accordion-body">
        <ul id="eventos-list" class="list-group">
        </ul>
    </div>

<script>
    // Carga el archivo JSON y realiza el procesamiento de los datos
// Carga el archivo JSON y realiza el procesamiento de los datos
fetch('./json/agendaGirola.json')
    .then(response => response.json())
    .then(data => {
        const eventosList = document.getElementById('eventos-list');

        // Recorre los datos del archivo JSON y crea dinámicamente los elementos <li>
        data.forEach(evento => {
            const li = document.createElement('li');
            const h6 = document.createElement('h6');
            const cuando = document.createElement('p');
            const donde = document.createElement('p');
            const span = document.createElement('span');

            li.classList.add('list-group-item');
            h6.classList.add('titEvento');
            cuando.classList.add('cuandoEvento');
            donde.classList.add('dondeEvento');
            span.classList.add('badge', 'bg-secondary');
            span.setAttribute('id', `${evento.id}`);

            h6.innerHTML = `${evento.titEvento}`;
            cuando.innerHTML = `¿Cuando?: ${formatoFechaArgentina(evento.fecha)} - ${evento.horario} hs`;
            donde.innerHTML = `¿Donde?: ${evento.direccion} - ${evento.lugar}`;
            span.innerHTML = '';

            // Agrega el elemento <li> al elemento <ul>
            eventosList.appendChild(li);
            li.appendChild(h6);
            li.appendChild(cuando);
            li.appendChild(donde);
            li.appendChild(span);

            // Calcula los días restantes y establece el contenido y color del badge
            establecerBadge(new Date(evento.fecha), evento.id);
        });
    })
    .catch(error => console.error('Error al cargar el archivo JSON:', error));

// Función para calcular la diferencia en días y establecer el contenido y color del badge
function establecerBadge(fechaFutura, idBadge) {
    // Obtenemos la fecha actual
    let fechaActual = new Date();

    // Convertimos la fecha futura a objeto Date si no lo es
    if (!(fechaFutura instanceof Date)) {
        fechaFutura = new Date(fechaFutura);
    }

    // Calculamos la diferencia en milisegundos
    let diferencia = fechaFutura.getTime() - fechaActual.getTime();

    // Convertimos la diferencia de milisegundos a días
    let dias = Math.floor(diferencia / (1000 * 60 * 60 * 24));

    const badge = document.getElementById(idBadge);

    if (dias === 0) {
        badge.innerText = 'Hoy!';
        badge.classList.remove('bg-secondary') // Quita el color gris
        badge.classList.add('bg-danger'); // Cambiar color a rojo
    } else if (dias < 0) {
        badge.innerText = 'Pasado';
        badge.classList.remove('bg-secondary') // Quita el color gris
        badge.classList.add('bg-success'); // Cambiar color a verde
    } else {
        badge.innerText = dias + ' días';
    }
}

// Función para formatear la fecha en formato argentino (dd/mm/yyyy)
function formatoFechaArgentina(fecha) {
    const fechaFormateada = new Date(fecha);
    return fechaFormateada.toLocaleDateString('es-AR');
}

</script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>

</body>

</html>
